<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<title>allWebPlugin - allWebOffice中间件Tab页切换示例</title>
	 <link href="layui/css/layui.css" rel="stylesheet">
	 <link href="layui/css/layuiExtend.css" rel="stylesheet">
	<script type="text/javascript" src="layui/layui.js"></script>
	<script type="text/javascript" src="leftNav/jquery.min.js"></script>
	<script type="text/javascript" src="js/allWebPlugin.Common.v2.0.0.28.js"></script>
	<script type="text/javascript" src="js/allWebPlugin.UI.v2.0.0.28.js"></script>
	<script type="text/javascript" src="js/allWebPlugin.Main.v2.0.0.28.js"></script>	
</head>
<style>
.top_1{
    text-align: right;
}



.glyphicon {
    position: relative;
    top: 1px;
    display: inline-block;
    font-family: 'Glyphicons Halflings';
    font-style: normal;
    font-weight: 400;
    line-height: 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

@media (min-width: 768px)
.form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
}
.input-date {
    bottom: 2px;
}
.input-group {
    position: relative;
    display: table;
    border-collapse: separate;
}


.col-sm-10 {
    width: 75%;
	float: left;
}

.col-sm-2 {
    width: 24.3%;
	float: left;
}



.layui-tab {
    margin: 0px 0; 
    text-align: left!important;
}
.layui-tab-title .layui-this {
    color: #ffffff;
	font-weight:bolder;
	
}
.layui-tab-title .layui-this:after {
   
    border-bottom: 2px solid #5672a7;
	/*
	 background-color:#009688;
	color:#ffffff;
	*/
}


.ibox {
    clear: both;
    margin-bottom: 25px;
    margin-top: 0;
    padding: 0;
}

.checkbox, .radio {
    position: relative;
    display: block;
    margin-top: 10px;
    margin-bottom: 10px;
}
.checkbox label, .radio label {
    min-height: 20px;
    padding-left: 20px;
    margin-bottom: 0;
    font-weight: 400;
    cursor: pointer;
}
label {
    display: inline-block;
    max-width: 100%;
    margin-bottom: 5px;
    font-weight: 700;
}
.center {
    padding-left: 15px;
    padding-right: 15px;
}
.pt-5 {
    padding-top: 5px;
}

.layui-form-radio {
    display: inline-block;
    vertical-align: middle;
    line-height: 2px; 
    /* margin: 6px 10px 0 0; */
    padding-right: 10px;
    cursor: pointer;
    font-size: 0;
}
.radio span {
    position: relative;
    bottom: 0px; 
}

</style>
<body>
	<div style="width: 1200px; margin: 0 auto; font-size: 13px;">
		<div>
			<a href="javascript:openLocalFile();">打开本地文件</a>
			<a href="javascript:openOnWebFile();">打开在线文件</a>
			<a href="javascript:saveFile();">保存文档</a>
			<a href="javascript:closeFile();">关闭文档</a>
			<a href="javascript:destroyContainer();">销毁插件容器</a>
			&nbsp;&nbsp;&nbsp;
			特色功能：
			<a href="javascript:createNew(g_allWebPlugin.ActivateContainer.ObjectAx,'Word.Document');">新建Word</a>
			<a href="javascript:createNew(g_allWebPlugin.ActivateContainer.ObjectAx,'Excel.Sheet');">新建Excel</a>
		</div>
	
          <div class="col-sm-10">
		       <div class="handle-box">
			   <!---handle-content-->
			       <div class="handle-content">
				      <!---layui-tab layui-tab-brief-->  
						   <div class="layui-tab-ex layui-tab-brief-ex" >
									  <ul class="layui-tab-title-ex">
										<li data_id="tab_bd" class="layui-this-ex" >本单位处理单</li>
										<li data_id="tab_zw" id="zhengwen">正文</li>
										<li data_id="tab_jbhj" id="jbhj">经办环节</li>
									  </ul>
									  <div class="layui-tab-content-ex">
											<div id="tab_bd">
											      <div id="tab-1" >
										<input type="text" name="title"   id="title"  value=""/>
<button type="button" class="layui-btn layui-btn-sm layui-btn-normal" onclick="javascript:window.open('');">打印</button>
                                                                                                                </div>
											</div>
											<!--正文-->
											<div style="height:0px;overflow:hidden;" id="tab_zw">
												<div id="DivID" style="width:100%;height:900px;">
													<text>输入焦点测试: </text><input type="text" name="title1" id="title1" value=""/>
														<!--<canvas id="pluginUI" width="1000" height="800">
															<p class="error">Sorry, It looks as though your browser does not support the canvas tag.</p>
														</canvas>-->
														<canvas id="allWebOfficeAx_zw" style="margin-top: 20px;width:50%;height:50%">
															<p class="error">Sorry, It looks as though your browser does not support the canvas tag.</p>
														</canvas>
					
												</div>
											</div>
										    <!--正文end-->
											
										
										<!--经办环节-->
											<div style="height:0px;overflow:hidden;" id="tab_jbhj">
												<div id="bd_jbhj" style="width:100%;height:100%;">
													<text>输入焦点测试: </text><input type="text" name="title2" id="title2" value=""/>
													<table style="width:100%;height:100%;">
													<tr style="width:100%;height:100%;">
													<td >
													 <canvas id="allWebOfficeAx_jb" classid="CLSID:6888ECA8-57D0-6E0E-9B9B-F1FF9B2DBD86" style="margin-top: 20px" width="500px" height="450px">
															<p class="error">Sorry, It looks as though your browser does not support the canvas tag.</p>
													</canvas>
													</td>
													
													<td >
													<canvas id="allWebOfficeAx_jb2" classid="CLSID:6888ECA8-57D0-6E0E-9B9B-F1FF9B2DBD86" style="margin-top: 20px;" width="500px" height="450px">
															<p class="error">Sorry, It looks as though your browser does not support the canvas tag.</p>
													</canvas>
													</td>
													</tr>
													</table>
	                                             </div>
											</div>
											<!--经办环节end-->
									  </div>
									  <!--layui-tab-content-ex end-->
						  </div>

						  <!---layui-tab layui-tab-brief-->  
					</div>  
					  <!---handle-content end-->
				 </div>
            </div>
           <!---col-sm-10 end-->
	</div>
</body> 
</html>
<script type="text/javascript">
function destroyContainer(){
	g_allWebPlugin.destroyContainer(g_allWebPlugin.ActivateContainer);
}

function init(){
	var installPackageUrl = "http://127.0.0.1:6651/install/allwebPlugin_x86_v2.0.1.16_20240806.exe";
	var installPackageVersion = "2.0.0.28";	
	if(awp_IsInstall(installPackageVersion,installPackageUrl)){
		//{6888ECA8-57D0-6E0E-9B9B-F1FF9B2DBD86} allWebOffice
		//{C7F277DC-6C47-AB2C-FB6A-070DC8BE7533} suwellreader
		//{D89F482C-5045-4DB5-8C53-D2C9EE71D025} 老东家iWebOffice2015
		//{9BE31822-FDAD-461B-AD51-BE1D1C159921}  VLC
		//{082ECC40-38F1-4E8F-82D3-216009A96686}  RSignReader	
		awp_CreatePlugin("allWebOfficeAx_zw","{6888ECA8-57D0-6E0E-9B9B-F1FF9B2DBD86}");
		awp_CreatePlugin("allWebOfficeAx_jb");
		awp_CreatePlugin("allWebOfficeAx_jb2");
		allWebOfficeAx_zw.GetDisplayStyle().ShowMenuBar = false;
		allWebOfficeAx_zw.GetDisplayStyle().ShowOpenProgress = false;
		allWebOfficeAx_jb.GetDisplayStyle().ShowMenuBar = false;
		allWebOfficeAx_jb.GetDisplayStyle().ShowOpenProgress = false;
		allWebOfficeAx_jb2.GetDisplayStyle().ShowMenuBar = false;
		allWebOfficeAx_jb2.GetDisplayStyle().ShowOpenProgress = false;
	}
}
	
function OnCreated(){
 // openFile();
}

/*
*打开远程大文档
*/
function openOnWebFile(){
	if(!g_allWebPlugin.ActivateContainer) return;
	var activateContainer = g_allWebPlugin.ActivateContainer;
	var pluginUtilityObj = activateContainer.getPluginUtility();
	var httpclientObj = activateContainer.getHttpClient();
	httpclientObj.Clear();
	if (httpclientObj.Open(0, "http://127.0.0.1:6651/doc/test2.docx", false)) {
		httpclientObj.Send().then(function(data){
			if (httpclientObj.GetStatus() == 200) {
				var varTempPath = pluginUtilityObj.GetTempPath();
				var varFile = pluginUtilityObj.GetTempFileName(varTempPath,"zso") + ".docx";
				httpclientObj.ResponseSaveToFile(varFile);
				activateContainer.ObjectAx.Open(varFile);
				activateContainer.ObjectAx.DeleteAfterClose = true;
			}
			else{
				alert("LoadFile test2.docx Status:" + httpclientObj.GetStatus() + ",请确保安装目录下web/doc目录存在test2.docx");
			}
			httpclientObj.Close();
		});	
	 }
}

	/**
	 * 打开本地文件 
	 */
function openLocalFile(){
	if(!g_allWebPlugin.ActivateContainer) return;
	var activateContainer = g_allWebPlugin.ActivateContainer;
	var pluginUtilityObj = activateContainer.getPluginUtility();
	pluginUtilityObj.GetLocalOpenDialog("docx文件(*.docx;*.doc);;excel文件(*.xls;*.xlsx);;所有文件(*.*)").then(function(varFile){
		console.log(varFile);
		if(varFile != "")
			activateContainer.ObjectAx.Open_Asyn(varFile);
	});
}	

	/**
	 * 获取文件并保存文件
	 */
	function saveFile(){
		if(g_allWebPlugin.ActivateContainer.ObjectAx){
			var newfileContent = g_allWebPlugin.ActivateContainer.ObjectAx.GetFileBase64();
			console.log(newfileContent);
			// 把文件内容保存到服务端
		}
	}

	/**
	 * 关闭文档 
	 */
	function closeFile(){
		g_allWebPlugin.ActivateContainer.ObjectAx.Close();
	}

	/**
	 * 创建新文档
	 * Word.Document
	 * Excel.Sheet
	 */
	function createNew(allWebOffce,strProgId){
		if(!allWebOffce) return;
		allWebOffce.CreateNew(strProgId);
	}

	window.onload = function(){
		// 加载控件
		init();
		
		
	}

</script>


<script>
//--------------------------------------选项卡js----------------------------------------------------------------------------
	$(function(){
			var isLoadJbhj=0;   //加载公文流程记录
			var isLoadfgyj=0;   //加载发改意见
			var isLoaddzwyj=0;
			var isLoadjb = 0;
			var ta=$('.layui-tab-ex');
            var tas = ta.find('li');

			tas.each(function(index){
				$(this).click(function(){
					  tas.removeClass("layui-this-ex");
					  $(this).addClass("layui-this-ex");
					  var data_id=$(this).attr('data_id');
					$('#'+data_id).show();
					if(data_id=='tab_bd'){
						document.getElementById("tab_zw").style.overflow='hidden';
						document.getElementById("tab_jbhj").style.overflow='hidden';
						document.getElementById("allWebOfficeAx_zw").style.overflow ='hidden';
						document.getElementById("allWebOfficeAx_jb").style.overflow ='hidden';
						document.getElementById("allWebOfficeAx_jb2").style.overflow ='hidden';
						//document.getElementById("tab_bd").style.height="100%";
						document.getElementById("tab_zw").style.height="0px";
						document.getElementById("tab_jbhj").style.height="0px";
						if(awp_getContainer("allWebOfficeAx_zw"))
							awp_getContainer("allWebOfficeAx_zw").UI.ForceShowUI(false);
						if(awp_getContainer("allWebOfficeAx_jb"))
							awp_getContainer("allWebOfficeAx_jb").UI.ForceShowUI(false);
						if(awp_getContainer("allWebOfficeAx_jb2"))
							awp_getContainer("allWebOfficeAx_jb2").UI.ForceShowUI(false);
                                                
					}else if(data_id=='tab_zw'){
						document.getElementById("tab_bd").style.overflow='hidden';
						document.getElementById("tab_jbhj").style.overflow='hidden';
						document.getElementById("allWebOfficeAx_zw").style.display ='block';
						document.getElementById("allWebOfficeAx_jb").style.overflow ='hidden';
						document.getElementById("allWebOfficeAx_jb2").style.overflow ='hidden';
						document.getElementById("tab_bd").style.height="0px";
						document.getElementById("tab_jbhj").style.height="0px";
						//document.getElementById("tab_zw").style.height="620px";
						
						g_allWebPlugin.ActivateContainer = awp_getContainer("allWebOfficeAx_zw");
						if(awp_getContainer("allWebOfficeAx_zw"))
						{
							awp_getContainer("allWebOfficeAx_zw").UI.ForceShowUI(true);
							awp_getContainer("allWebOfficeAx_zw").UI.onUpdatePosition(0);
						}
						if(awp_getContainer("allWebOfficeAx_jb"))
							awp_getContainer("allWebOfficeAx_jb").UI.ForceShowUI(false);
						if(awp_getContainer("allWebOfficeAx_jb2"))
							awp_getContainer("allWebOfficeAx_jb2").UI.ForceShowUI(false);
						
						if(isLoaddzwyj === 0)
							createNew(allWebOfficeAx_zw,'Excel.Sheet');
						isLoaddzwyj = 1;
					}else if(data_id=='tab_jbhj'){
						document.getElementById("tab_bd").style.overflow='hidden';
						document.getElementById("tab_zw").style.overflow='hidden';
						document.getElementById("allWebOfficeAx_zw").style.display ='hidden';
						document.getElementById("allWebOfficeAx_jb").style.overflow ='block';
						document.getElementById("allWebOfficeAx_jb2").style.overflow ='block';
						
                        document.getElementById("tab_bd").style.height="0px";
						document.getElementById("tab_zw").style.height="0px";
						if(awp_getContainer("allWebOfficeAx_zw")){
							awp_getContainer("allWebOfficeAx_zw").UI.ForceShowUI(false);
						}
						if(awp_getContainer("allWebOfficeAx_jb")){
							awp_getContainer("allWebOfficeAx_jb").UI.ForceShowUI(true);
							awp_getContainer("allWebOfficeAx_jb").UI.onUpdatePosition(0);
						}
						if(awp_getContainer("allWebOfficeAx_jb2")){
							awp_getContainer("allWebOfficeAx_jb2").UI.ForceShowUI(true);
							awp_getContainer("allWebOfficeAx_jb2").UI.onUpdatePosition(0);
						}
						g_allWebPlugin.ActivateContainer = awp_getContainer("allWebOfficeAx_jb");
						if(isLoadjb === 0)
						{
							createNew(allWebOfficeAx_jb,'Word.Document');
							createNew(allWebOfficeAx_jb2,'Word.Document');
						}
						isLoadjb = 1;
					}
					document.getElementById(data_id).style.height="100%";
				})
				

			}) 
				
      })
</script>